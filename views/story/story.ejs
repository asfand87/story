<% layout('layouts/boilerplate') -%>

<div class="container min-vh-100">
  <div class="row my-5">
    <div class="col-6 my-5">
      <figure class="figure">
        <h5><b>Title</b> : <%=story.title%></h5>
        <img
          src="<%=story.image  %>"
          class="img-fluid mw-100 mt-3"
          alt="A generic square placeholder image with rounded corners in a figure."
        />
        <figcaption class="figure-caption mb-3">
          <%=story.description %>
        </figcaption>
        <p><b>Location</b> : <%=story.location%></p>
        <div class="buttons d-flex justify-content-between">
          <div class="__formContent">
            <form
              action="/story/<%=story._id%>?_method=DELETE"
              method="POST"
              class="d-inline"
            >
              <button class="btn btn-danger p-2" type="submit">
                <i class="fas fa-trash">Delete</i>
              </button>
            </form>
            <a href="/story/<%=story._id%>/edit" class="btn btn-secondary p-2"
              ><i class="fas fa-edit">Edit</i></a
            >
          </div>
        </div>
      </figure>
    </div>
    <div class="col-6 my-5">
      <form
        action="/story/<%=story._id%>/comment"
        method="POST"
        class="validated-form"
        novalidate
      >
        <div class="my-4">
          <label for="author">Author</label>
          <input
            type="text"
            name="comment[author]"
            class="form-control"
            placeholder="Author"
            id="author"
            required
          />
        </div>
        <div class="mb-3 mt-2">
          <label for="description">Comment</label>
          <textarea
            type="text"
            name="comment[comment]"
            class="form-control my-3"
            placeholder="Comment"
            id="comment"
            required
          ></textarea>
        </div>
        <button class="btn btn-primary btn-success">Comment</button>
      </form>
      <div class="row">
        <% for(let comment of story.comments){ %>
        <div class="card my-5">
          <div class="card-body">
            <h6 class="card-subtitle mb-2 text-muted">
              <!-- i set it to author.email but in course its review.author.username -->
              By : <%=comment.author %>
            </h6>
            <p class="card-text">Review: <%=comment.comment %></p>

            <form
              class="d-inline"
              method="POST"
              action="/story/<%=story._id%>/comment/<%=comment._id%>?_method=DELETE"
            >
              <button class="btn btn-sm btn-danger">Delete</button>
            </form>
            <a
              class="btn btn-sm btn-secondary"
              href="/story/<%=story._id%>/comment/<%=comment._id%>/edit"
              >Edit</a
            >
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
